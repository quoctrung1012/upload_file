<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{TITLE}}</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css" rel="stylesheet">

  <style>
      /* Custom styles for Excel preview */
      body {
          background-color: #f8f9fa;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }

      .main-header {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          padding: 2rem 0;
          margin-bottom: 2rem;
      }

      .main-header h1 {
          margin: 0;
          font-weight: 300;
      }

      .main-header .lead {
          opacity: 0.9;
          margin-top: 0.5rem;
      }

      .sheet-tabs {
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          margin-bottom: 2rem;
      }

      .nav-tabs .nav-link {
          border: none;
          color: #6c757d;
          font-weight: 500;
          padding: 1rem 1.5rem;
          transition: all 0.3s ease;
          border-radius: 10px 10px 0 0;
      }

      .nav-tabs .nav-link:hover {
          background-color: #f8f9fa;
          color: #495057;
      }

      .nav-tabs .nav-link.active {
          background-color: #007bff;
          color: white;
          border-color: #007bff;
      }

      .tab-content {
          background: white;
          border-radius: 0 0 10px 10px;
          padding: 0;
      }

      .tab-content > .tab-pane {
          transition: none !important;
      }

      .sheet-info {
          background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
          padding: 1.5rem;
          border-radius: 10px;
          margin: 1.5rem;
          border-left: 4px solid #007bff;
      }

      .sheet-info .info-item {
          display: inline-flex;
          align-items: center;
          margin-right: 2rem;
          color: #495057;
      }

      .sheet-info .info-item i {
          margin-right: 0.5rem;
          color: #007bff;
      }

      .table-container {
          margin: 1.5rem;
          border-radius: 10px;
          overflow: hidden;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }

      .table {
          margin: 0;
          font-size: 0.9rem;
      }

      .table th {
          background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
          color: white;
          font-weight: 600;
          text-align: center;
          padding: 1rem 0.75rem;
          border: none;
          position: sticky;
          top: 0;
          z-index: 10;
      }

      .table td {
          padding: 0.75rem;
          border: 1px solid #dee2e6;
          vertical-align: middle;
          transition: background-color 0.2s ease;
      }

      .table tr:hover td {
          background-color: #f8f9fa;
      }

      .table .numeric {
          text-align: right;
          font-family: 'Courier New', monospace;
          font-weight: 500;
          color: #28a745;
      }

      .table .text-cell {
          max-width: 200px;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
      }

      .table .empty-cell {
          background-color: #f8f9fa;
          color: #6c757d;
          font-style: italic;
      }

      .row-number {
          background-color: #e9ecef;
          color: #6c757d;
          font-weight: 600;
          text-align: center;
          width: 60px;
          min-width: 60px;
      }

      .loading {
          display: flex;
          justify-content: center;
          align-items: center;
          height: 200px;
      }

      .fade-in {
          animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
      }

      /* Responsive design */
      @media (max-width: 768px) {
          .table-container { margin: 1rem; }
          .sheet-info { margin: 1rem; }
          .nav-tabs .nav-link { padding: 0.75rem 1rem; }
          .main-header { padding: 1rem 0; }
      }

      /* Dark mode support */
      @media (prefers-color-scheme: dark) {
          body { background-color: #1a1a1a; color: #ffffff; }
          .sheet-tabs { background: #2d2d2d; }
          .table { background: #2d2d2d; color: #ffffff; }
          .table td { border-color: #404040; }
          .table tr:hover td { background-color: #3d3d3d; }
      }
  </style>
</head>
<body>
<!-- Header Section -->
<div class="main-header">
  <div class="container">
    <div class="row">
      <div class="col-12 text-center">
        <h1>
          <i class="bi bi-file-earmark-spreadsheet me-3"></i>
          {{TITLE}}
        </h1>
        <p class="lead">Excel Document Preview</p>
      </div>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <div class="sheet-tabs fade-in">
        <!-- Tab Navigation -->
        {{TAB_NAVIGATION}}

        <!-- Tab Content -->
        {{TAB_CONTENT}}
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<!-- Custom JavaScript -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Enhanced tab switching with loading animation
    const tabButtons = document.querySelectorAll('[data-bs-toggle="tab"]');
    tabButtons.forEach(button => {
      button.addEventListener('click', function(e) {
        const targetPane = document.querySelector(this.getAttribute('data-bs-target'));
        if (targetPane) {
          targetPane.style.opacity = '0.5';
          setTimeout(() => {
            targetPane.style.opacity = '1';
          }, 200);
        }
      });
    });

    // Add tooltip for truncated text
    const textCells = document.querySelectorAll('.text-cell');
    textCells.forEach(cell => {
      if (cell.scrollWidth > cell.clientWidth) {
        cell.style.cursor = 'help';
        cell.setAttribute('data-bs-toggle', 'tooltip');
        cell.setAttribute('data-bs-placement', 'top');
      }
    });

    // Initialize Bootstrap tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl);
    });

    // Add keyboard navigation
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey && e.key >= '1' && e.key <= '9') {
        const tabIndex = parseInt(e.key) - 1;
        const tabButton = document.getElementById(`tab-${tabIndex}`);
        if (tabButton) {
          tabButton.click();
          e.preventDefault();
        }
      }
    });

    // Auto-resize table columns
    function autoResizeColumns() {
      const tables = document.querySelectorAll('.table');
      tables.forEach(table => {
        const cells = table.querySelectorAll('td, th');
        cells.forEach(cell => {
          const content = cell.textContent.trim();
          if (content.length > 20) {
            cell.style.maxWidth = '300px';
          } else if (content.length < 5) {
            cell.style.minWidth = '80px';
          }
        });
      });
    }

    // Initialize auto-resize
    autoResizeColumns();

    // Add search functionality (optional)
    const searchInput = document.getElementById('tableSearch');
    if (searchInput) {
      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        const activeTable = document.querySelector('.tab-pane.active .table tbody');
        if (activeTable) {
          const rows = activeTable.querySelectorAll('tr');
          rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(searchTerm) ? '' : 'none';
          });
        }
      });
    }
  });
</script>
</body>
</html>